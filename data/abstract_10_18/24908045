OBJECTIVES: To compare and characterize extended-spectrum beta-lactamase (ESBL)-producing Escherichia coli from pigsties, pig farmers and their families on farms with previous high or no use of third- or fourth-generation cephalosporins. METHODS: Twenty farms with no third- or fourth-generation cephalosporin use and 19 herds with previous frequent use were included. The ESBL-producing isolates detected in humans and pigs were characterized by ESBL genotype, PFGE, susceptibility to non-beta-lactam antibiotics and phylotype, and selected isolates were characterized by multilocus sequence typing (MLST). Furthermore, transferability of bla(CTX-M-)1 from both human and pig isolates was studied and plasmid incompatibility groups were defined. The volunteers answered a questionnaire including epidemiological risk factors for carriage of ESBL-producing E. coli. RESULTS: ESBL-producing E. coli was detected in pigs on 79% of the farms with high consumption of cephalosporins compared with 20% of the pigs on farms with no consumption. ESBL-producing E. coli was detected in 19 of the 195 human participants and all but one had contact with pigs. The genes found in both humans and pigs at the same farms were blaCTX-M-1 (eight farms), bla(CTX-M-14) (one farm) and bla(SHV-12) (one farm). At four farms ESBL-producing E. coli isolates with the same CTX-M enzyme, phylotype, PFGE type and MLST type were detected in both pigs and farmers. The majority of the plasmids with bla(CTX-M-1) were transferable by conjugation and belonged to incompatibility group IncI1, IncF, or IncN. CONCLUSIONS: The present study shows an increased frequency of ESBL-producing E. coli on farms with high consumption of third- or fourth-generation cephalosporins and indicates transfer of either ESBL-producing E. coli or plasmids between pigs and farmers.