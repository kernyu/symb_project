BACKGROUND: There is limited available data on the strain diversity of M tuberculosis in Peru, though there may be interesting lessons to learn from a setting where multidrug resistant TB has emerged as a major problem despite an apparently well-functioning DOTS control programme. METHODS: Spoligotyping was undertaken on 794 strains of M tuberculosis collected between 1999 and 2005 from 553 community-based patients and 241 hospital-based HIV co-infected patients with pulmonary tuberculosis in Lima, Peru. Phylogenetic and epidemiologic analyses permitted identification of clusters and exploration of spoligotype associations with drug resistance. RESULTS: Mean patient age was 31.9 years, 63% were male and 30.4% were known to be HIV+. Rifampicin mono-resistance, isoniazid mono-resistance and multidrug resistance (MDR) were identified in 4.7%, 8.7% and 17.3% of strains respectively. Of 794 strains from 794 patients there were 149 different spoligotypes. Of these there were 27 strains (3.4%) with novel, unique orphan spoligotypes. 498 strains (62.7%) were clustered in the nine most common spoligotypes: 16.4% SIT 50 (clade H3), 12.3% SIT 53 (clade T1), 8.3% SIT 33 (LAM3), 7.4% SIT 42 (LAM9), 5.5% SIT 1 (Beijing), 3.9% SIT 47 (H1), 3.0% SIT 222 (clade unknown), 3.0% SIT1355 (LAM), and 2.8% SIT 92 (X3). Amongst HIV-negative community-based TB patients no associations were seen between drug resistance and specific spoligotypes; in contrast HIV-associated MDRTB, but not isoniazid or rifampicin mono-resistance, was associated with SIT42 and SIT53 strains. CONCLUSION: Two spoligotypes were associated with MDR particularly amongst patients with HIV. The MDR-HIV association was significantly reduced after controlling for SIT42 and SIT53 status; residual confounding may explain the remaining apparent association. These data are suggestive of a prolonged, clonal, hospital-based outbreak of MDR disease amongst HIV patients but do not support a hypothesis of strain-specific propensity for the acquisition of resistance-conferring mutations.