OBJECTIVES: To identify the roles of various antibiotics as risk factors for carbapenem-resistant extended-spectrum beta-lactamase (ESBL)-producing Klebsiella pneumoniae (KP) infection (ESBL-KP infection). METHODS: Data were collected over 26 months in a tertiary care university hospital with established endemicity of carbapenem-resistant ESBL-KP (ESBL-CRKP). Using a case-case-control design, patients who presented an infection caused by carbapenem-susceptible ESBL-KP (ESBL-CSKP) and patients with ESBL-CRKP infection were compared with a common control group of hospitalized patients. Effects of treatment and duration of treatment with antibiotics were examined, adjusting for major non-antibiotic risk factors and controlling for confounding effects among the antibiotics via logistic regression models. RESULTS: Ninety-six ESBL-CRKP cases, 55 ESBL-CSKP cases and 151 controls were analysed. Multivariate analysis, adjusting for major non-antibiotic risk factors, showed that the risk of ESBL-CRKP infection rose with increasing duration of prior treatment with beta-lactam/beta-lactamase inhibitor combinations [odds ratio (OR) 1.15 per day increase; P = 0.001] and revealed that increased duration of treatment with fluoroquinolones amplified the impact of exposure to carbapenems (and vice versa) on ESBL-CRKP infection risk (OR 1.02 for interaction term; P = 0.009). Duration of prior treatment with fluoroquinolones was also associated with increased risk of ESBL-CSKP infection (OR 1.07 per day increase; P = 0.028), while prior receipt of carbapenems presented a protective effect against ESBL-CSKP infection (OR 0.21; P = 0.003). CONCLUSIONS: This study highlights the major role of treatment and duration of treatment with beta-lactam/beta-lactamase inhibitor combinations and combinations of carbapenems with fluoroquinolones. Clinicians should counterweight the potential benefits of administering these antibiotics against the increased risk of ESBL-CRKP infection.