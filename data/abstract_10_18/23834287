Genes specifying the thiamin monophosphate phosphatase and adenylated thiazole diphosphatase steps in fungal and plant thiamin biosynthesis remain unknown, as do genes for ThDP (thiamin diphosphate) hydrolysis in thiamin metabolism. A distinctive Nudix domain fused to Tnr3 (thiamin diphosphokinase) in Schizosaccharomyces pombe was evaluated as a candidate for these functions. Comparative genomic analysis predicted a role in thiamin metabolism, not biosynthesis, because free-standing homologues of this Nudix domain occur not only in fungi and plants, but also in proteobacteria (whose thiamin biosynthesis pathway has no adenylated thiazole or thiamin monophosphate hydrolysis steps) and animals (which do not make thiamin). Supporting this prediction, recombinant Tnr3 and its Saccharomyces cerevisiae, Arabidopsis and maize Nudix homologues lacked thiamin monophosphate phosphatase activity, but were active against ThDP, and up to 60-fold more active against diphosphates of the toxic thiamin degradation products oxy- and oxo-thiamin. Deleting the S. cerevisiae Nudix gene (YJR142W) lowered oxythiamin resistance, overexpressing it raised resistance, and expressing its plant or bacterial counterparts restored resistance to the YJR142W deletant. By converting the diphosphates of damaged forms of thiamin into monophosphates, the Tnr3 Nudix domain and its homologues can pre-empt the misincorporation of damaged diphosphates into ThDP-dependent enzymes, and the resulting toxicity.