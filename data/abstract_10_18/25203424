Rice stripe virus (RSV) causes one of the most serious viral diseases of rice (Oryza sativa L.), but the molecular basis of RSV resistance has remained elusive. Here we show that the resistant allele of rice STV11 (STV11-R) encodes a sulfotransferase (OsSOT1) catalysing the conversion of salicylic acid (SA) into sulphonated SA (SSA), whereas the gene product encoded by the susceptible allele STV11-S loses this activity. Sequence analyses suggest that the STV11-R and STV11-S alleles were predifferentiated in different geographic populations of wild rice, Oryza rufipogon, and remained prevalent in cultivated indica and japonica rice varieties, respectively. Introgression of the STV11-R allele into susceptible cultivars or heterologous transfer of STV11-R into tobacco plants confers effective resistance against RSV. Our results shed new insights into plant viral defense mechanisms and suggest effective means of breeding RSV-resistant crops using molecular marker-assisted selection or genetic engineering.