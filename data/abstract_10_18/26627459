The intestinal immune system is tailored to fight pathogens effectively while tolerating the indigenous microbiota. Impairments of this homeostatic interaction may contribute to the etiology of various diseases including inflammatory bowel diseases. However, the molecular architecture underlying this complex regulatory interaction is not well understood. Here, we show that the fruit fly Drosophila melanogaster has a multilayered intestinal immune system that ensures strictly localized antimicrobial responses. Enterocytes, a major cell population of the intestine, produced antimicrobial peptides (AMPs) in a FoxO- but not NF-kappaB-dependent manner. Consequently, animals impaired in FoxO-mediated signaling had a significantly lowered resistance to intestinal infections; they were unable to increase the expression of AMP genes and males showed an increased bacterial load in response to an infection. Conventional innate immune signaling converging onto NF-kappaB activation was operative in only a few regions of the intestine, comprising the proventriculus, copper cells, and intestinal stem cells. Taken together, our results imply that danger-mediated as well as conventional innate immune signaling constitute modules that contribute to the fruit fly's intestinal immune system. We propose that this special architecture ensures localized and efficient antimicrobial responses against invasive pathogens while preserving the microbiota.