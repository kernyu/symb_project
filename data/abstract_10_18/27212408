Emergence of antibiotic resistance, an evolutionary process of major importance for human health [1], often occurs under changing levels of antibiotics. Selective sweeps, in which resistant cells become dominant in the population, are a critical step in this process [2]. While resistance emergence has been studied in laboratory experiments [3-8], the full progression of selective sweeps under fluctuating stress, from stochastic events in single cells to fixation in populations, has not been characterized. Here, we study fluctuating selection using Escherichia coli populations engineered with a stochastic switch controlling tetracycline resistance. Using microfluidics and live-cell imaging, we treat multiple E. coli populations with the same total amount of tetracycline but administered in different temporal patterns. We find that populations exposed to either short or long antibiotic pulses are likely to develop resistance through selective sweeps, whereas intermediate pulses allow higher growth rates but suppress selective sweeps. On the basis of single-cell measurements and a dynamic growth model, we identify the major determinants of population growth and show that both physiological memory and environmental durations can strongly modulate the emergence of resistance. Our detailed quantification in a model synthetic system provides key lessons on the interaction between single-cell physiology and selection that should inform the design of treatment regimens [9-12] and the analysis of phenotypically diverse populations adapting under fluctuating selection [13-17].