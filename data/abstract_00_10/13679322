BACKGROUND: The relationship between previous antimicrobial treatments and infection with drug-resistant Helicobacter pylori is unknown. OBJECTIVES: To determine whether previous use of antimicrobial agents predicts subsequent antibiotic resistance of H. pylori and whether resistance affects treatment outcome. DESIGN: Retrospective cohort analysis of adults recruited sequentially from a clinical practice. SETTING: A referral hospital in Anchorage, Alaska. PATIENTS: 125 adults infected with H. pylori. MEASUREMENTS: Medical records were reviewed for antimicrobial agents prescribed in the 10 years before diagnosis with H. pylori infection. Antimicrobial susceptibility of H. pylori isolates obtained from endoscopic gastric biopsy was determined by using agar dilution. Cure was determined by using the urea breath test 2 months after antimicrobial treatment. RESULTS: Among the 125 patients, 37 (30%) were found to have H. pylori isolates resistant to clarithromycin and 83 (66%) were found to have H. pylori isolates resistant to metronidazole. Resistance to clarithromycin was associated with previous use of any macrolide antibiotic (P < 0.001), and resistance to metronidazole was associated with previous use of metronidazole (P < 0.001). The odds of isolates being resistant to clarithromycin increased in relation to the number of courses of macrolides received (P < 0.001). Among 53 persons treated with clarithromycin-based regimens, treatment failed in 77% of those carrying clarithromycin-resistant H. pylori (10 of 13) and 13% of those with clarithromycin-susceptible strains (5 of 40) (relative risk, 6.2 [95% CI, 1.9 to 37.1]; P < 0.001). CONCLUSIONS: Previous use of macrolides and metronidazole is associated with H. pylori resistant to these antimicrobial agents. Clarithromycin resistance is associated with a greater risk for failure with clarithromycin-based treatments.