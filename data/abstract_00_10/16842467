BACKGROUND: The clinical management of Helicobacter pylori infected patients who failed standard eradication therapies remains a challenge. AIM: To investigate the efficacy of rifabutin-based triple therapy and high-dose dual therapy for rescue treatment of H. pylori, and the correlation between cytochrome P450 2C19 (CYP2C19) polymorphisms and treatment outcome. METHODS: Patients infected with H. pylori resistant to both metronidazole and clarithromycin (n = 145) were randomized to either esomeprazole 20 mg, rifabutin 150 mg and amoxicillin 1 g, each given b.d. for 7 days (ERA), or to omeprazole 40 mg and amoxicillin 1000 mg, each given t.d.s. for 14 days (OA). Crossover therapy was offered in cases of persistent infection. CYP2C19 polymorphisms were determined by polymerase chain reaction restriction fragment length polymorphism. RESULTS: Intention-to-treat and per-protocol eradication rates were: ERA 74% (62.4-83.6) and 78% (66.7-87.3); high-dose OA 70% (57.5-79.7) and 75% (62.5-84.5). Crossover therapy was successful in seven of 10 patients with ERA and in eight of 10 patients with OA. Premature discontinuation of treatment occurred in 2% and 5% of patients, respectively. There was only a non-significant trend to lower eradication rates in homozygous extensive metabolizers. CONCLUSIONS: Triple therapy with esomeprazole, rifabutin and amoxicillin and high-dose omeprazole/amoxicillin are comparable and effective and safe for rescue therapy of H. pylori regardless of the patient's CYP2C19 genotype.