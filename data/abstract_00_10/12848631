BACKGROUND: There is currently no optimal second-line treatment after failure of Helicobacter pylori triple therapy. AIM: To determine effective salvage therapy after failure of lansoprazole-amoxicillin-clarithromycin. METHODS: After failure of lansoprazole-amoxicillin-clarithromycin 123 out-patients were randomized to receive either 2-week rabeprazole (20 mg b.d.) + amoxicillin (1000 mg b.d.) (RA group) or 1-week rabeprazole (10 mg b.d.) + amoxicillin (750 mg twice b.d.) + metronidazole (250 mg b.d.) (RAM group). Eradication was assessed by the 13C-urea breath test. We also evaluated cytochrome p450 (CYP) 2C19 genotype status, determined by polymerase chain reaction - restriction fragment length polymorphism, and susceptibility to clarithromycin and metronidazole. RESULTS: On an intention-to-treat basis, H. pylori infection cure was achieved in 37 of 63 (59%) patients in the RA group and in 49 of 60 (82%) patients in the RAM group. Per protocol-based eradication rates in the RA and RAM groups were 66% (37/56) and 88% (49/56), respectively. In both analytic sets there were significant differences between the treatment groups (P < 0.01 in each). Mild adverse events were observed in eight and five patients from the RA and RAM groups, respectively. Genetic predisposition of CYP2C19 and antibiotic resistance did not influence the treatment outcome either regimen. CONCLUSIONS: The rabeprazole + amoxicillin + metronidazole therapy yielded satisfactory results. In contrast, the cure rate in high-dose rabeprazole + amoxicillin was below an acceptable level.