We present a mathematical model for malaria treatment and spread of drug resistance in an endemic population. The model considers treated humans that remain infectious for some time and partially immune humans who are also infectious to mosquitoes although their infectiousness is always less than their non immune counterparts. The model is formulated by considering delays in the latent periods in both mosquito and human populations and in the period within which partial immunity is lost. Qualitative analysis of the model including positivity and boundedness of solutions is performed. Analysis of the reproductive numbers shows that if the treated humans become immediately uninfectious to mosquitoes then treatment will always reduce the number of sensitive infections. If however treated humans are infectious then for treatment to effectively reduce the number of sensitive infections, the ratio of the infectious period of the treated humans to the infectious period of the untreated humans multiplied by the ratio of the transmission rate from a treated human to the transmission rate of an untreated human should be less than one. Our results show that the spread of drug resistance with treatment as a control strategy depends on the ratio of the infectious periods of treated and untreated humans and on the transmission rates from infectious humans with resistant and sensitive infections. Numerical analysis is performed to assess the effects of treatment on the spread of resistance and infection. The study provides insight into the possible intervention strategies to be employed in malaria endemic populations with resistant parasites by identifying important parameters.