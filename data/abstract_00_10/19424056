OBJECTIVE: Identification of low-frequency variants is of clinical importance in the identification of preexisting drug resistance. Using 'ultra-deep' sequencing, we address the detection of potential resistance to the chemokine (C-C motif) receptor 5 (CCR5) antagonist, maraviroc, due to the pretreatment presence of low levels of chemokine (CXC motif) receptor 4 (CXCR4)-using virus. METHODS: We present a novel protocol for the phenotyping of HIV based on '454' pyrosequence data and apply this to two large data sets comprised of 104 628 (before treatment, day 1) and 191 637 (after treatment, day 11) reads from the envelope region. We study resistance in the context of the evolutionary history of the intrapatient viral population. Variation was also investigated both within and outside the V3 region, the region associated with the receptor switch. RESULTS: CXCR4-using virus can be detected at low frequency prior to maraviroc treatment ( approximately 0.5%) and at high frequency after failure of monotherapy ( approximately 81%). Inferring an evolutionary tree from the 1674 unique reads that span the V3 region confirms that the CXCR4-using population emerged from low-frequency CXCR4-using variants present before treatment. Changes in the frequency of amino acid residues used at individual sites were found in regions outside the V3 region, indicative of other potential sites associated with receptor usage. CONCLUSION: We have provided a high-resolution snapshot of intrapatient viral variation, prior and after treatment with maraviroc, and detected preexisting CXCR4-using variants present at an extremely low frequency. The evolutionary analysis demonstrates the extent of diversity present at a single time point within an infected individual and the rapid effect of drug pressure on the structure of a viral population.