BACKGROUND: The burden of Plasmodium vivax infections has been underappreciated, especially in southeast Asia where chloroquine resistant strains have emerged. Our aim was to compare the safety and efficacy of dihydroartemisinin-piperaquine with that of artemether-lumefantrine in patients with uncomplicated malaria caused by multidrug-resistant P falciparum and P vivax. METHODS: 774 patients in southern Papua, Indonesia, with slide-confirmed malaria were randomly assigned to receive either artemether-lumefantrine or dihydroartemisinin-piperaquine and followed up for at least 42 days. The primary endpoint was the overall cumulative risk of parasitological failure at day 42 with a modified intention-to-treat analysis. This trial is registered with ClinicalTrials.gov, trial number 00157833. FINDINGS: Of the 754 evaluable patients enrolled, 466 had infections with P falciparum, 175 with P vivax, and 113 with a mixture of both species. The overall risk of failure at day 42 was 43% (95% CI 38-48) for artemether-lumefantrine and 19% (14-23) for dihydroartemisinin-piperaquine (hazard ratio=3.0, 95% CI 2.2-4.1, p<0.0001). After correcting for reinfections, the risk of recrudescence of P falciparum was 4.4% (2.6-6.2) with no difference between regimens. Recurrence of vivax occurred in 38% (33-44) of patients given artemether-lumefantrine compared with 10% (6.9-14.0) given dihydroartemisinin-piperaquine (p<0.0001). At the end of the study, patients receiving dihydroartemisinin-piperaquine were 2.0 times (1.2-3.6) less likely to be anaemic and 6.6 times (2.8-16) less likely to carry vivax gametocytes than were those given artemether-lumefantrine. INTERPRETATION: Both dihydroartemisinin-piperaquine and artemether-lumefantrine were safe and effective for the treatment of multidrug-resistant uncomplicated malaria. However, dihydroartemisinin-piperaquine provided greater post-treatment prophylaxis than did artemether-lumefantrine, reducing P falciparum reinfections and P vivax recurrences, the clinical public-health importance of which should not be ignored.