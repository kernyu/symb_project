BACKGROUND: HIV-1-infected patients vary considerably by their response to antiretroviral treatment, drug concentrations in plasma, toxic events, and rate of immune recovery. This variability could have a genetic basis. We did a pharmacogenetics study to analyse the association between response to antiretroviral treatment and allelic variants of several genes. METHODS: In 123 patients, we did PCR analyses of the gene for the multidrug-resistance transporter (MDR1), which codes for P-glycoprotein, of genes coding for isoenzymes of cytochrome P450, CYP3A4, CYP3A5, CYP2D6, and CYP2C19, and of the gene for the chemokine receptor CCR5. We measured concentrations in plasma of the antiretroviral agents efavirenz and nelfinavir by high-performance liquid-chromatography, and measured levels of P-glycoprotein expression, CD4-cell count, and HIV-1 viraemia. FINDINGS: Median drug concentrations in patients with the MDR1 3435 TT, CT, and CC genotypes were at the 30th, 50th, and 75th percentiles, respectively (p=0.0001). In patients with CYP2D6 extensive-metaboliser or poor-metaboliser alleles, median drug concentrations were at percentiles 45 and 62.5, respectively (p=0.04). Patients with the MDR1 TT genotype 6 months after starting treatment had a greater rise in CD4-cell count (257 cells/microL) than patients with the CT (165 cells/microL) and CC (121 cells/microL) genotype (p=0.0048), and the best recovery of naive CD4-cells. INTERPRETATION: The polymorphism MDR1 3435 C/T predicts immune recovery after initiation of antiretroviral treatment. This finding suggests that P-glycoprotein has an important role in admittance of antiretroviral drugs to restricted compartments in vivo.