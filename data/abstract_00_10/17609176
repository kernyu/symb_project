The spread of H5N1 avian influenza and the recent high numbers of confirmed human cases have raised international concern about the possibility of a new pandemic. Therefore, antiviral drugs are now being stockpiled to be used as a first line of defence. The large-scale use of antivirals will however exert a strong selection pressure on the virus, and may lead to the emergence of drug-resistant strains. A few mathematical models have been developed to assess the emergence of drug resistance during influenza pandemics. These models, however, neglected the spatial structure of large populations and the stochasticity of epidemic and demographic processes. To assess the impact of population structure and stochasticity, we modify and extend a previous model of influenza epidemics into a metapopulation model which takes into account the division of large populations into smaller units, and develop deterministic and stochastic versions of the model. We find that the dynamics in a fragmented population is less explosive, and, as a result, prophylaxis will prevent more infections and lead to fewer resistant cases in both the deterministic and stochastic model. While in the deterministic model the final level of resistance during treatment is not affected by fragmentation, in the stochastic model it is. Our results enable us to qualitatively extrapolate the prediction of deterministic, homogeneous-mixing models to more realistic scenarios.