BACKGROUND: Sulfadoxine-pyrimethamine was a common first line drug therapy to treat uncomplicated falciparum malaria, but increasing therapeutic failures associated with the development of significant levels of resistance worldwide has prompted change to alternative treatment regimes in many national malaria control programs. METHODOLOGY AND FINDING: We conducted an in vivo therapeutic efficacy trial of sulfadoxine-pyrimethamine at two locations in the Peruvian Amazon enrolling 99 patients of which, 86 patients completed the protocol specified 28 day follow up. Our objective was to correlate the presence of polymorphisms in P. falciparum dihydrofolate reductase and dihydropteroate synthase to in vitro parasite susceptibility to sulfadoxine and pyrimethamine and to in vivo treatment outcomes. Inhibitory concentration 50 values of isolates increased with numbers of mutations (single [108N], sextuplet [BR/51I/108N/164L and 437G/581G]) and septuplet (BR/51I/108N/164L and 437G/540E/581G) with geometric means of 76 nM (35-166 nM), 582 nM (49-6890- nM) and 4909 (3575-6741 nM) nM for sulfadoxine and 33 nM (22-51 nM), 81 nM (19-345 nM), and 215 nM (176-262 nM) for pyrimethamine. A single mutation present in the isolate obtained at the time of enrollment from either dihydrofolate reductase (164L) or dihydropteroate synthase (540E) predicted treatment failure as well as any other single gene alone or in combination. Patients with the dihydrofolate reductase 164L mutation were 3.6 times as likely to be treatment failures [failures 85.4% (164L) vs 23.7% (I164); relative risk = 3.61; 95% CI: 2.14 - 6.64] while patients with the dihydropteroate synthase 540E were 2.6 times as likely to fail treatment (96.7% (540E) vs 37.5% (K540); relative risk = 2.58; 95% CI: 1.88 - 3.73). Patients with both dihydrofolate reductase 164L and dihydropteroate synthase 540E mutations were 4.1 times as likely to be treatment failures [96.7% vs 23.7%; RR = 4.08; 95% CI: 2.45 - 7.46] compared to patients having both wild forms (I164 and K540). CONCLUSIONS: In this part of the Amazon basin, it may be possible to predict treatment failure with sulfadoxine-pyrimethamine equally well by determination of either of the single mutations dihydrofolate reductase 164L or dihydropteroate synthase 540E. TRIAL REGISTRATION: ClinicalTrials.gov NCT00951106.