BACKGROUND: Sulfadoxine-pyrimethamine was first introduced for treatment of malaria in Africa during the early 1980s for cases when chloroquine treatment failed, and has since become the first-line treatment in many countries. Resistance to sulfadoxine-pyrimethamine is now increasing, especially in southeast Africa. METHODS: We characterised genetic change in dhfr and dhps genes in the Plasmodium falciparum population of KwaZulu-Natal, South Africa, during 1995-99, a period of rapid deterioration of the effectiveness of sulfadoxine-pyrimethamine. We assessed the evolutionary origin of the resistance by analysing polymorphic microsatellite repeats in the flanking region of the dhfr and dhps genes, which show whether resistance alleles originated through shared or independent ancestral mutation events. We then assessed the current extent of dispersal of dhfr and dhps resistance alleles by doing the same analysis in P falciparum sampled from communities in the Kilimanjaro region of northern Tanzania in 2001. FINDINGS: The large genetic change during 1995-99 in KwaZulu-Natal, South Africa, in both the health facility and the wider community surveys, was at the dhps locus, apparently because resistance at dhfr was established before 1995. The allelic determinants of resistance in this province share a common evolutionary origin with those found in Kilimanjaro, Tanzania, even though the two sites are 4000 km apart. INTERPRETATION: Three resistant dhfr alleles, and one resistant dhps allele, each derived from independent ancestral lineages, have been driven through through southeast Africa. The movement by the dhfr alleles (pyrimethamine resistance) preceded that of the dhps allele (sulfadoxine resistance). Our findings emphasise that gene flow rather than new mutations has been the most common originator of resistance in African countries.