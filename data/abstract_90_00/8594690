The factors which identify patients at risk of treatment failure were characterized in 1590 children and adults with uncomplicated falciparum malaria treated with 15 or 25 mg/kg of mefloquine on the borders of Thailand. Six independent predictors of failure were identified using multiple logistic regression. Age < or = 2 years (odds ratio [OR] 4.54), 3-15 years (OR 4.4), vomiting < 30 min after a single dose of 25 mg/kg (despite re-administration of the dose) (OR 2.5) and diarrhoea after treatment (OR 3.6) were the strongest predictors of failure by day 7. Parasitaemias > 10 000/mm3 (OR 1.4), and fever with a history of recent vomiting (OR 1.6) were risk factors for recrudescence of the infection between days 10 and 28. Patients treated with mefloquine in the previous 2 months were also at increased risk of failure (OR 2.38), particularly if they were anaemic (haematocrit < 30%) (OR 5.96), which suggested that they had recrudescent infections at presentation. Combined, these 6 factors identified half of all treatment failures. Vomiting and diarrhoea accounted for 24% of the early failures in children. Patients at increased risk of treatment failure should be monitored closely and given early alternative treatment if fever and parasites persist for > or = 3 d.