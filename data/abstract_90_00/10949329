SETTING: Cases of rifampin-resistant Mycobacterium tuberculosis from the prison population in Madrid and from the general population in Spain. OBJECTIVE: To identify the rpoB mutations associated with resistance to rifampin and to investigate rpoB genotyping as an epidemiological marker in rifampin-resistant M. tuberculosis. DESIGN: Twenty-nine rifampin-resistant clinical isolates of M. tuberculosis, 15 obtained from the prison population in Madrid and 14 from the general population in Spain, were characterized by sequence analysis of the 81-bp core region of the rpoB gene and IS6110 DNA fingerprinting. RESULTS: All the isolates had mutations in rpoB, with those in codon 531 accounting for 41% of the total. Twenty-three (79%) isolates were highly resistant to rifampin (minimum inhibitory concentration > or = 64 mg/L). Nineteen different IS6110 fingerprints were observed: one was shared by seven isolates, one by three, two by two, and 15 were unique. Two IS6110 clusters could be divided into subclusters on the basis of rpoB analysis. Epidemiologic links were identified among patients whose isolates had identical IS6110 patterns and rpoB genotypes, but not between those with identical IS6110 patterns and different rpoB genotypes. CONCLUSION: Characterization of rpoB mutations can provide information about susceptibility to rifampin and be a useful epidemiological tool for discrimination of rifampin-resistant strains of M. tuberculosis with identical IS6110 fingerprints.