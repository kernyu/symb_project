We combine standard pharmacokinetics with an established model of viral replication to predict the outcome of therapy as a function of adherence to the drug regimen. We consider two types of treatment failure: failure to eliminate the wild-type virus, and the emergence of drug-resistant virus. Specifically, we determine the conditions under which resistance dominates as a result of imperfect adherence. We derive this result for both single- and triple-drug therapies, with attention to conditions which favour the emergence of viral strains that are resistant to one or more drugs in a cocktail. Our analysis provides quantitative estimates of the degree of adherence necessary to prevent resistance. We derive results specific to the treatment of human immunodeficiency virus infection, but emphasize that our method is applicable to a range of viral or other infections treated by chemotherapy.